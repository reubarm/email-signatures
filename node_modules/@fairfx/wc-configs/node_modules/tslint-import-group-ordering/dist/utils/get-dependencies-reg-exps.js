"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const nodejs_modules_1 = require("./nodejs-modules");
const nodeModulesPath = 'node_modules';
const packageJsonPath = 'package.json';
exports.getNodeJsModulesRegExps = () => nodejs_modules_1.nodejsModules.map(regExpMatchingPrefixFactory);
exports.getNodeModulesRegExps = () => getNodeModules().map(regExpMatchingPrefixFactory);
exports.getPackageJsonDependenciesRegExps = () => readDependenciesFromPackageJson().map(regExpMatchingPrefixFactory);
function getNodeModules() {
    if (!fs_1.existsSync(nodeModulesPath)) {
        return [];
    }
    return fs_1.readdirSync(nodeModulesPath);
}
function readDependenciesFromPackageJson() {
    if (!fs_1.existsSync(packageJsonPath)) {
        return [];
    }
    const packageJsonContents = fs_1.readFileSync(packageJsonPath, 'utf8');
    try {
        const parsedPackageJson = JSON.parse(packageJsonContents);
        const dependencies = Object.keys(parsedPackageJson.dependencies || {});
        const devDependencies = Object.keys(parsedPackageJson.devDependencies || {});
        return [...dependencies, ...devDependencies];
    }
    catch (error) {
        return [];
    }
}
const regExpMatchingPrefixFactory = (prefix) => new RegExp(`^${prefix}`);
